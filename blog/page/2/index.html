
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Paulo Suzart Blog</title>
  <meta name="author" content="Paulo Suzart">

  
  <meta name="description" content="Some seconds after the last post, @paraseba commented that a text version of this notation may be even more helpful. Here it is: $ means provided by &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://paulosuzart.github.com/blog/page/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Paulo Suzart Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26676810-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Paulo Suzart Blog</a></h1>
  
    <h2>Functional thoughts.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:paulosuzart.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/12/11/my-own-redis-types-text-notation/">My Own REDIS Types - Text - Notation</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2011-12-11T18:11:00-02:00" pubdate>Dec 11<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/12/11/my-own-redis-types-text-notation/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Some seconds after the <a href="http://paulosuzart.github.com/blog/2011/12/11/my-own-redis-types-notation/">last post</a>, <a href="http://twitter.com/paraseba">@paraseba</a> commented that a text version of this notation may be even more helpful.</p>

<p>Here it is:</p>

<ul>
<li><code>$</code> means provided by some interaction with redis.</li>
<li><code>*</code> means provided by user.</li>
<li><code>key</code> represents a redis KEY with the value set by <code>SET</code>.</li>
<li><code>(listkey)</code> represents a redis LIST with elements manipulated by <code>LPUSH</code> and so on.</li>
<li><code>{hashkey [key values]}</code> represents a redis <code>HASH</code> with data set by <code>HSET</code> or <code>HMSET</code>.</li>
<li><code>#{setkey data}</code> represents a set or sorted set.</li>
<li><code>as $varname</code> may be used for situations where <code>INCR</code> is used to generate an ID.</li>
</ul>


<p>The last post user creation process may be written as:</p>

<pre><code>users:next as $uid
{users:$uid data}
#{users:pending:confirmation $uid)
#{messages:welcome $uid}
(users:send:mail *mail)
</code></pre>

<p>An instance of this process would be:</p>

<pre><code>users:next ;; suppose 21 as result
{users:21 [name Abraao mail somemailhere@gmail.com status pending-mail-confirmation]}
#{users:pending:confirmation 21)
#{messages:welcome 21}
(users:send:mail somemailhere@gmail.com)
</code></pre>

<p>It is the form I&#8217;m using as doc strings in a namespace. It looks great with <a href="http://www.fogus.me/fun/marginalia/">Marginalia</a>.</p>

<p>Don&#8217;t forget to visit the <a href="/about">about</a> page. And follow me on Twitter: <a href="http://twitter.com/paulosuzart">@paulosuzart</a>.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/12/11/my-own-redis-types-notation/">My Own REDIS Types Notation</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2011-12-11T17:20:00-02:00" pubdate>Dec 11<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/12/11/my-own-redis-types-notation/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the greatest <a href="http://en.wikipedia.org/wiki/NoSQL">NoSQL</a> <a href="http://en.wikipedia.org/wiki/NoSQL#Key-value_store">key-value</a> databases I value most, is <a href="http://redis.io/">redis</a>. It is simple, fast and tasty.</p>

<p>You interact with redis through its protocol. They are divided by commands that you can apply to its different data structures. These structures are Key, String, Hashes, Lists, Sets, Sorted Sets and channels (this one used for <a href="http://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern">pub/sub pattern</a>).</p>

<p>Since redis is key-value, it means you can store only keys with values. Right? It may sound bad at the beginning, but you get the way as you try. I&#8217;m just a newbe in redis world and I&#8217;m feeling comfortable with it.</p>

<p>So, due to its key-value nature you should create some structures around you main structure to help you query your data. Suppose you are using a redis <code>HASH</code> to store user information. In a javascript notation:</p>

<pre><code>HMSET  users:21 name Abra√£o mail somemailhere@gmail.com status pending-mail-confirmation
</code></pre>

<p><code>HMSET</code> is a command to store all the <code>HASH</code> entries into a <code>HASH</code> identified by <code>user:21</code> key. And for some reason, your system get all users pending mail confirmation and send them a remember. There is no way to get all the users that has mail confirmation pending other than check every user status, what would be expensive. A helper structure may save you from this.</p>

<pre><code>SADD users:pending:confirmation 21
</code></pre>

<p>Bingo. Now your background process can pick up users to remember mail confirmation from the <code>SET</code> identified by <code>users:pending:confirmation</code> key.</p>

<p>Suppose you also want to show a welcome message to the user in the first time it visits you. You may use another helper structure.</p>

<pre><code>SADD messages:welcome 21
</code></pre>

<p>Thus, your system queries a <code>SET</code> identified by <code>messages:welcome</code> key to check if it should show a welcome message to the user. And finally, at the moment of user&#8217;s creation, your system wants to send some information through mail also in a back ground process. Again a helper structure.</p>

<pre><code>LPUSH users:send:mail somemailhere@gmail.com
</code></pre>

<p>Lot of thing to just create a user. Now imagine a big code base and even complex interactions with other helper structures like sorted sets to store information related to age, date, etc. It was my situation last week while interacting with redis.</p>

<p>To make things clear and easy to remember and document. I created a simple, yet helpful (for me at least) notation to document redis structures and the sequence of interactions. Te symbols are:</p>

<p><img src="https://s3.amazonaws.com/suzart.blogs.posts/redislayout/Slide1.jpg" alt="redis Types Notation" /></p>

<p>Now our user&#8217;s creation process using the notation we have:</p>

<p><img src="https://s3.amazonaws.com/suzart.blogs.posts/redislayout/Slide4.jpg" alt="User's creation interactions" /></p>

<p>It is simple and is helping a lot. Another good thing I started to do is to write queries in plain english (portuguese actually :)) to help identify which types of queries a structure is helping me to answer. To see a text version of it, visit this <a href="http://paulosuzart.github.com/blog/2011/12/11/my-own-redis-types-text-notation/">new post</a>.</p>

<p>I&#8217;m using <a href="https://github.com/mmcgrana/clj-redis/">clj-redis</a> interact with redis.</p>

<p>Don&#8217;t forget to visit the <a href="/about">about</a> page. And follow me on Twitter: <a href="http://twitter.com/paulosuzart">@paulosuzart</a>.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/12/04/korma-and-clojure-records/">Korma and Clojure Records</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2011-12-04T19:02:00-02:00" pubdate>Dec 4<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/12/04/korma-and-clojure-records/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://sqlkorma.com">Korma</a> is a <a href="http://clojure.org">clojure</a> framework (by <a href="http://twitter.com/ibdknox">@ibdknox</a>) that provides great SQL abstractions. You can work purely with clojure code without inserting SQL strings into your code.</p>

<p>Consider the following entities:</p>

<figure class='code'><figcaption><span>Using defentity </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'> <span class="p">(</span><span class="nf">defdb</span> <span class="nv">mydb</span> <span class="p">(</span><span class="nf">mysql</span>
</span><span class='line'>                     <span class="p">{</span><span class="nv">:port</span> <span class="mi">3306</span>
</span><span class='line'>                       <span class="nv">:host</span> <span class="s">&quot;localhost&quot;</span>
</span><span class='line'>                       <span class="nv">:user</span> <span class="s">&quot;root&quot;</span>
</span><span class='line'>                       <span class="nv">:db</span> <span class="s">&quot;korma_post&quot;</span><span class="p">}))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defentity</span> <span class="nv">email</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">database</span> <span class="nv">mydb</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defentity</span> <span class="nv">person</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">has-one</span> <span class="nv">email</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">database</span> <span class="nv">mydb</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>email</code> is the representation of the email table in a mysql database. Note that you don&#8217;t need to specify any fields. It is optional. In this case, both entities will return the column&#8217;s name as map keys in a given select. Let&#8217;s see:</p>

<figure class='code'><figcaption><span>Selecting your data </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nb">select </span><span class="nv">person</span> <span class="p">(</span><span class="nf">with</span> <span class="nv">email</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;;will return</span>
</span><span class='line'><span class="p">[{</span><span class="nv">:id</span> <span class="mi">1</span><span class="o">,</span> <span class="nv">:name</span> <span class="s">&quot;Paulo Suzart&quot;</span><span class="o">,</span>
</span><span class='line'>   <span class="nv">:age</span> <span class="mi">29</span><span class="o">,</span> <span class="nv">:id_2</span> <span class="mi">1</span><span class="nv">x,</span>
</span><span class='line'>   <span class="nv">:email</span> <span class="s">&quot;paulosuzart@gmail.com&quot;</span><span class="o">,</span>
</span><span class='line'>   <span class="nv">:person_id</span> <span class="mi">1</span><span class="p">}</span>
</span><span class='line'> <span class="p">{</span><span class="nv">:id</span> <span class="mi">2</span><span class="o">,</span>
</span><span class='line'>   <span class="nv">:name</span> <span class="s">&quot;Rafael Felini&quot;</span><span class="o">,</span>
</span><span class='line'>   <span class="nv">:age</span> <span class="mi">27</span><span class="o">,</span>
</span><span class='line'>   <span class="nv">:id_2</span> <span class="mi">2</span><span class="o">,</span>
</span><span class='line'>   <span class="nv">:email</span> <span class="s">&quot;rafael.felini@gmail.com&quot;</span><span class="o">,</span>
</span><span class='line'>   <span class="nv">:person_id</span> <span class="mi">2</span><span class="p">}]</span>
</span></code></pre></td></tr></table></div></figure>


<p>The result look like a java Resultset. You can choose the original column names to pass around your application. And since clojure is not type safe or compiled, you may find yourself suffering in cases of database refactories.</p>

<p>A nice solution is to combine Korma <code>entities</code> with <code>transform</code> function and clojure <code>defrecord</code> to get rid of this problem, as well as diminish the surface contact of your code concerned with database access. One solution we (me and <a href="http://twitter.com/rafaelfelini">@rafaelfelini</a>) have found was:</p>

<figure class='code'><figcaption><span>Combining entities with transform and defrecord </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">defrecord</span> <span class="nv">Person</span> <span class="p">[</span><span class="nv">id</span> <span class="nv">name</span> <span class="nv">age</span> <span class="nv">email</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defentity</span> <span class="nv">person</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">transform</span> <span class="o">#</span><span class="p">(</span><span class="nv">Person</span><span class="o">.</span> <span class="p">(</span><span class="nf">:id</span> <span class="nv">%</span><span class="p">)</span> <span class="p">(</span><span class="nf">:name</span> <span class="nv">%</span><span class="p">)</span> <span class="p">(</span><span class="nf">:age</span> <span class="nv">%</span><span class="p">)</span> <span class="p">(</span><span class="nf">:email</span> <span class="nv">%</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">has-one</span> <span class="nv">email</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">database</span> <span class="nv">mydb</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;; now try again</span>
</span><span class='line'><span class="p">(</span><span class="nb">select </span><span class="nv">person</span> <span class="p">(</span><span class="nf">with</span> <span class="nv">email</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;; will return</span>
</span><span class='line'><span class="p">(</span><span class="o">#</span><span class="nv">:user</span><span class="o">.</span><span class="nv">Person</span><span class="p">{</span><span class="nv">:id</span> <span class="mi">1</span><span class="o">,</span>
</span><span class='line'>                         <span class="nv">:name</span> <span class="s">&quot;Paulo Suzart&quot;</span><span class="o">,</span>
</span><span class='line'>                         <span class="nv">:age</span> <span class="mi">29</span><span class="o">,</span>
</span><span class='line'>                         <span class="nv">:email</span> <span class="s">&quot;paulosuzart@gmail.com&quot;</span><span class="p">}</span>
</span><span class='line'> <span class="o">#</span><span class="nv">:user</span><span class="o">.</span><span class="nv">Person</span><span class="p">{</span><span class="nv">:id</span> <span class="mi">2</span><span class="o">,</span>
</span><span class='line'>                         <span class="nv">:name</span> <span class="s">&quot;Rafael Felini&quot;</span><span class="o">,</span>
</span><span class='line'>                         <span class="nv">:age</span> <span class="mi">27</span><span class="o">,</span>
</span><span class='line'>                         <span class="nv">:email</span> <span class="s">&quot;rafael.felini@gmail.com&quot;</span><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>transform</code> function takes another function that transforms a database record (with the column names as keys) into a clojure&#8217;s record. In this case <code>Person</code> is the record - that always holds the e-mail. Korma takes care of the join, assuming that the <code>email</code> table has a column called <code>person_id</code>.</p>

<p>Now your code is a bit more resilient to database changes with this thing layer of transformation. Actually a good practice you&#8217;ve done all life as developer.</p>

<p>Korma can do a lot of things to make your life easier, as the abililty to compose queries, and performs really nice. Think I finally found THE framework for relational data access in clojure.</p>

<p>Don&#8217;t forget to visit the <a href="/about">about</a> page. And follow me on Twitter: <a href="http://twitter.com/paulosuzart">@paulosuzart</a>.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/30/dateparammatcher-for-finagle/">DateParamMatcher for Finagle</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2011-10-30T23:22:00-02:00" pubdate>Oct 30<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/30/dateparammatcher-for-finagle/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://twitter.github.com/finagle">Twitter Finagle</a> is an amazing framework for RPC communication, and my interest is its HTTP features for creating RESTful APIs.</p>

<p>As I bloged at <a href="http://codemountain.wordpress.com/2011/10/14/twitter-finagle-primeiras-impressoes/">codemountain</a>, I&#8217;m using finagle for a personal project. Don&#8217;t know how far it will go, but the facts is that I&#8217;m learning Finagle a lot.</p>

<p>During this project I needed to extract from the query string, a param to be parsed to a twitter.util.Time. I ended up with a Param Matcher to be used my a pattern match agains the requested path. The use of this Param Patcher is:</p>

<figure class='code'><figcaption><span>Using the DateParamMatcher</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="c1">//...</span>
</span><span class='line'><span class="nc">Path</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="o">)</span> <span class="o">:?</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>       <span class="k">case</span> <span class="nc">Root</span> <span class="o">/</span> <span class="s">&quot;myPath&quot;</span> <span class="o">:?</span> <span class="nc">RequestTime</span><span class="o">(</span><span class="n">requestTimeParam</span><span class="o">)</span>  <span class="k">=&gt;</span> <span class="c1">//do something</span>
</span><span class='line'><span class="c1">//..</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="c1">//Where RequestTime is defined as</span>
</span><span class='line'> <span class="k">object</span> <span class="nc">RequestTime</span> <span class="k">extends</span> <span class="nc">DateParamMatcher</span><span class="o">(</span><span class="s">&quot;requestTimeParam&quot;</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The source of DateParamMatcher is the following.</p>

<figure class='code'><figcaption><span>Param Matcher for twitter.util.Time</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">import</span> <span class="nn">com.twitter.util.Time._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">com.twitter.util.Time</span>
</span><span class='line'><span class="k">import</span> <span class="nn">java.text.ParseException</span>
</span><span class='line'><span class="k">import</span> <span class="nn">com.twitter.finagle.http.path._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">com.twitter.finagle.http.ParamMap</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Extractor that takes a request parameter and converts it to a {twitter.util.Time}.</span>
</span><span class='line'><span class="cm"> * The date format should conform with {twitter.util.Time} default format.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="k">abstract</span> <span class="k">class</span> <span class="nc">DateParamMatcher</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="n">unapply</span><span class="o">(</span><span class="n">params</span><span class="k">:</span> <span class="kt">ParamMap</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Time</span><span class="o">]</span> <span class="k">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="n">name</span><span class="o">)</span> <span class="n">flatMap</span> <span class="o">{</span> <span class="n">value</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>      <span class="nc">Some</span><span class="o">(</span><span class="n">at</span><span class="o">(</span><span class="n">value</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span> <span class="k">catch</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="n">ex</span><span class="k">:</span> <span class="kt">ParseException</span> <span class="o">=&gt;</span>
</span><span class='line'>        <span class="nc">None</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finagle also provides an abstract <code>com.twitter.finagle.http.path.ParamMatcher</code> as well as <code>LongParamMatcher</code> and <code>IntParamMatcher</code> in the same package. They are actually Scala  Extractors (very well explained <a href="http://codemonkeyism.com/scala-goodness-extractors/">here</a> by @codemonkeyism). This is a practical way to extract values from a query string and put it available at your code already parsed.</p>

<p>Note that if the param named <code>requestTimeParam</code> is not present or carries a invalid value for <code>Time</code> in the query string the <code>None</code> value is returned.</p>

<p>Although easy to build and extract params from query string and requested path, it is not a Finagle strength. It is kinda limited. A better abstraction is offered by <a href="https://github.com/unfiltered/unfiltered">Unfiltered</a>(another <a href="http://twitter.com/n8han">@n8han&#8217;s</a> great job).</p>

<p>Hope you enjoy it.</p>

<p>Don&#8217;t forget to visit the <a href="/about">about</a> page. And follow me on Twitter: <a href="http://twitter.com/paulosuzart">@paulosuzart</a>.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/30/what-you-are-supposed-to-find-here/">What You Are Supposed to Find Here</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2011-10-30T23:09:00-02:00" pubdate>Oct 30<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/30/what-you-are-supposed-to-find-here/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Hi, this is another blog of mine. Yap, I have a - mostly in portuguese - wordpress called <a href="http://codemountain.wordpress.com">codemountain</a>, and a <a href="http://posterous.com/paulosuzart">Posterous</a>. Maybe I move to here and kill the others. Don&#8217;t know yet.</p>

<p>The main reason to starting blogging directly on my Github is to keep the subjects even more focused on projects committed here, and share some experiences with some libs also committed here.</p>

<p>Don&#8217;t forget to visit the <a href="/about">about</a> page. And follow me on Twitter: <a href="http://twitter.com/paulosuzart">@paulosuzart</a>.</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/08/26/geocoding-csvs-with-clojure/">Geocoding CSVs with Clojure</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/08/21/docker-plus-ansible/">Docker + Ansible</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/20/janus-plus-ack-grep-plus-fish-shell-tools-to-rule-everything/">Janus + ack-grep + fish shell: Tools to rule everything</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/07/configuring-clojure-immutant-by-environment/">Configuring Clojure Immutant by environment</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/09/tcp-server-with-clojure-aleph-and-gloss/">TCP Server with Clojure Aleph and Gloss</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/paulosuzart">@paulosuzart</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'paulosuzart',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("paulosuzart", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/paulosuzart" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @paulosuzart</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Paulo Suzart -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'paulosuzartblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
