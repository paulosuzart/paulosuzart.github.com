<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <title>
    Give Kotlin And Quasar a Try &middot; 
    my blog at github.io
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.png">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">


  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26676810-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</head>


  <body>

    <header class="masthead">
      <div class="masthead-inner">
        <h1><a href="/">Paulo Suzart</a></h1>
        <p>Functional programming (mostly with clojure), virtualization and cloud computing.</p>

        <div class="colophon">
          <ul class="colophon-links">
            <li>
              <a href="https://github.com/paulosuzart">Codes</a>,
            </li>
          </ul>
        </div>
      </div>
    </header>

    <div class="content container">
      <div class="post">
  <h1>Give Kotlin And Quasar a Try</h1>
  <span class="post-date">30 May 2015</span>
  <p>Hello hello! After a quick incursion into the world of <s>Rust</s> language, I’m back!</p>

<p>The balance since last year when I started to work on a <a href="http://paulosuzart.github.io/blog/2014/07/07/going-back-to-go/">tracking system written</a> in Go is: I didn’t finish it (as if it is novelty). Also,  I had the opportunity to deliver a <a href="https://www.djangoproject.com/">danjgo</a> system to production with easy. I might return with the tracking stuff but not written in Go.</p>

<h2 id="kotlin">Kotlin</h2>

<p>Ok, so I’m here to give my 2 cents on a Language that I - have to admit - ignored for a long time. A language that was launched ~5 years ago, when <a href="http://www.scala-lang.org/">Scala</a> was taking over: <a href="kotlinlang.org">Kotlin</a>. You can find better details about why Kotlin in <a href="http://blog.jetbrains.com/">their blog</a>.</p>

<p>To be precise, yesterday they <a href="http://blog.jetbrains.com/kotlin/2015/05/kotlin-m12-is-out/">launched the M12</a> with relevant changes. The good thing is that those guys are not afraid of improving the language and deprecate things for good reasons.</p>

<p>Kotlin can compile to JVM, JavaScript and Android. What makes it a powerful language able to cover almost all areas you are deliverying code. Not only that, here a non-exhaustive list of characteristics that attracted me:</p>

<ul>
  <li><strong>Serious crafters</strong>. These guys are building a <strong>language</strong>, different from other groups that are creating a language as a masquerade just to embed a bunch of social experiments and social ideas behind them</li>
  <li><strong>Incredible interop with Java</strong> without bizzarre workarounds. That is why Kotlin can take advantage of all Java libs without having to reinvent the wheel using the language.</li>
  <li><strong>Statically</strong> typed, compiled. I’ve been working with Groovy (Grails) for at least 3 years. You can say <em>“you can write tests to give you some safety”</em>, ok, I respect, but I had to pay the price of dynamicity in production. What is not cheap.</li>
  <li><strong>Null is welcome, but without NPE</strong>. Some languages wind their optinal values in a object (<code>Option</code>, <code>Some</code>, <code>Either</code>, etc). Kotlin uses the concept of <a href="http://kotlinlang.org/docs/reference/null-safety.html">Null Safety</a> where you give a hint to inform if a value can be null, so the compile prevents accidental code without forcing you to write defensive code</li>
  <li><strong>Lambdas</strong> - Needless to comment</li>
  <li><a href="http://kotlinlang.org/docs/reference/inline-functions.html"><strong>Inlining</strong></a> - This is a super important direction to go. Hope that with Java 9, we developers become more responsible and active int terms of how compiler treats our code</li>
  <li><strong>Data Classes</strong> - Imagine a very concise and short way to code a class that just holds values, but providing <code>equals</code>, <code>hashcode</code>, <code>toString</code> and <code>copy</code> automatically. <a href="http://kotlinlang.org/docs/reference/data-classes.html">Data classes</a> are the answer</li>
  <li><strong>Native delegation</strong> - I can’t count how many times I had to use a delegate but doing everything by hand. Kotlin supports this pattern directly, <a href="http://kotlinlang.org/docs/reference/delegation.html">take a look here</a>.</li>
  <li><strong><a href="http://kotlinlang.org/docs/reference/exceptions.html">No checked exceptions</a></strong> \o/ -The compile never complies if you don’t <code>throw</code> an exception.</li>
</ul>

<p>And how could I feel the language? Simple: writing a project with it. That is why I ported a <code>systemd</code> like process monitor from <s>Rust</s> to Kotlin. Krust-pm can be found in this <a href="https://github.com/paulosuzart/krust-pm/tree/master">Github</a> repo.</p>

<h2 id="quasar">Quasar</h2>

<p>Another excelent piece of software is <a href="http://www.paralleluniverse.co/quasar/">Quasar from Parallel Universe</a>. I played with it using the <a href="https://github.com/puniverse/pulsar">Pulsar Clojure</a> wrapper a while ago. And nothing better than interop with Java to really stretch Kotlin.</p>

<p>Quasar provides light Fibers and Actors to JVM and the <a href="http://blog.paralleluniverse.co/2015/05/29/quasar-pulsar-0-7-0/">release 0.7.0</a> also got released yesterday. So, lets check.</p>

<p>If you open krust-pm project you’ll see that at least two classes extends from <a href="http://docs.paralleluniverse.co/quasar/javadoc/co/paralleluniverse/actors/behaviors/ProxyServerActor.html">ProxyServerActor</a>.</p>

<div class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"><span class="k">class</span> <span class="nc">ProcessManager</span><span class="p">()</span> <span class="p">:</span> <span class="n">ProxyServerActor</span><span class="p">(</span><span class="s">&quot;krust-pm&quot;</span><span class="p">,</span> <span class="k">true</span><span class="p">),</span>
                         <span class="n">ProcessManagerTrait</span> <span class="p">{</span>
    <span class="c1">//...</span>
<span class="p">}</span>
<span class="k">class</span> <span class="nc">ManagedProcess</span><span class="p">(</span><span class="k">private</span> <span class="k">val</span> <span class="py">name</span> <span class="p">:</span> <span class="n">String</span><span class="p">,</span>
                     <span class="k">private</span> <span class="k">val</span> <span class="py">cmd</span> <span class="p">:</span> <span class="n">String</span><span class="p">,</span>
                     <span class="k">private</span> <span class="k">val</span> <span class="py">maxRetries</span> <span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
                     <span class="k">private</span> <span class="k">var</span> <span class="py">initScale</span> <span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
                     <span class="k">private</span> <span class="k">val</span> <span class="py">env</span> <span class="p">:</span> <span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;)</span> <span class="p">:</span>
                     <span class="n">ProxyServerActor</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">true</span><span class="p">),</span> <span class="n">ManagedProcessTrait</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="k">val</span> <span class="py">actorA</span> <span class="p">=</span> <span class="n">ManagedProcess</span><span class="p">(</span><span class="s">&quot;good_sleeper&quot;</span><span class="p">,</span>
                              <span class="s">&quot;./src/main/resources/sleeper.py&quot;</span><span class="p">,</span>
                              <span class="m">3</span><span class="p">,</span>
                              <span class="m">2</span><span class="p">,</span>
                              <span class="n">mapOf</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">String</span><span class="p">&gt;()).</span><span class="n">spawn</span><span class="p">()</span> <span class="k">as</span> <span class="n">ManagedProcessTrait</span>

<span class="k">val</span> <span class="py">actorB</span> <span class="p">=</span> <span class="n">ProcessManager</span><span class="p">().</span><span class="n">spawn</span><span class="p">()</span> <span class="k">as</span> <span class="n">ProcessManagerTrait</span>

<span class="n">actorB</span><span class="p">.</span><span class="n">manage</span><span class="p">(</span><span class="n">actorA</span><span class="p">)</span> <span class="c1">// manage actorA is sent as a message to the actorB</span></code></pre></div>

<p>ProxyActor is part of the excellent builtin <a href="http://docs.paralleluniverse.co/quasar/">Behavior</a> Actors provided. This specific one creates a proxy of your class, that immediately becomes an actor without having to implement <code>doRun</code> or create a loop and pattern matching incoming messages. This is super, but might add a neglible overhead.</p>

<p>There are other provided behaviors like <code>Server</code>, <code>EventSource</code> and the great <a href="http://docs.paralleluniverse.co/quasar/javadoc/co/paralleluniverse/actors/behaviors/FiniteStateMachineActor.html">FiniteStateMachine</a> that I want to taste.</p>

<p>So, the next great thing about Galaxy is the <a href="http://docs.paralleluniverse.co/quasar/javadoc/co/paralleluniverse/strands/Strand.html">Strand</a> abstraction. Krust-pm, due to the nature o Java system process handling, employs a thread per managed process instance. And to keep a single uniform API around a thread that manages a process or any other fiber that can do anything different, I used the <code>of</code> static method from Strand to instantiate directly from a thread.</p>

<p>Quasar also offers the ability to <a href="http://docs.paralleluniverse.co/quasar/javadoc/co/paralleluniverse/actors/behaviors/Supervisor.html">supervise actors</a> and take actions accordingly. Another important thing is the custom configuration for <a href="http://docs.paralleluniverse.co/quasar/javadoc/co/paralleluniverse/actors/MailboxConfig.html">Actor Mailboxes</a> and configurable <a href="http://docs.paralleluniverse.co/quasar/javadoc/co/paralleluniverse/fibers/FiberScheduler.html">FiberScheduler</a>.</p>

<p>Moreover, if you are interested in distributing Actors across machines, there is a natural integration with <a href="http://docs.paralleluniverse.co/quasar/#enabling-clustering">Galaxy</a> available.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Both Quasar and Kotlin are proving themselves as great tools to keep in mind when developing your next solution. Kotlin because it is statically typed, better than java and still flexible enough to foster elegant, expressive and intuitive code.</p>

<p>And Quasa because it doesn’t impose any crazy concept like other Actor libs out there, also, it offers great abstractions and a straight to the point API.</p>


</div>

    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "paulosuzartblog"; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/blog/2015/09/23/database-functional-mapping-with-slick/">
            Database Functional Mapping with Slick
            <small>23 Sep 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/blog/2015/08/21/how-much-functional-are-you/">
            How Much Functional Are You?
            <small>21 Aug 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/blog/2015/04/02/why-racket-is-awesome/">
            Why Racket is Awesome
            <small>02 Apr 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
