<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Web Noir plus enlive template</title>
  <meta name="description" content="Hi again! Long time without writing here. But for a good reason.One of the most promising web frameworks for clojure is noir. It is actually an abstraction o...">

  <!-- CSS files -->
  <link rel="stylesheet" href="http://localhost:4000/css/font-awesome.min.css">
  <link rel="stylesheet" href="http://localhost:4000/css/main.css">

  <link rel="canonical" href="http://localhost:4000/blog/2012/03/25/web-noir-plus-enlive-template/">
  <link rel="alternate" type="application/rss+xml" title="Paulo Suzart" href="http://localhost:4000/feed.xml" />

  <!-- Icons -->
  <!-- 16x16 -->
  <link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
  <!-- 32x32 -->
  <link rel="shortcut icon" href="http://localhost:4000/favicon.png">
</head>


<body>
  <div class="row">
    <div class="col s12 m3">
      <div class="table cover">
        

<div class="cover-card table-cell table-middle">
  
  <a href="http://localhost:4000/" class="author_name">Paulo Suzart</a>
  <span class="author_job">FP and more</span>
  <span class="author_bio mbm">back end developer | machine Learning professional wannabe</span>
  <nav class="nav">
    <ul class="nav-list">
      <li class="nav-item">
        <a href="http://localhost:4000/">home</a>
      </li>
       
        
          <li class="nav-item">
            <a href="http://localhost:4000/archive/">Archive</a>
          </li>
        
          
        
          <li class="nav-item">
            <a href="http://localhost:4000/categories/">Categories</a>
          </li>
        
          
        
          <li class="nav-item">
            <a href="http://localhost:4000/tags/">Tags</a>
          </li>
        
        
        
           
        
           
        
           
        
          
    </ul>
  </nav>
  <script type="text/javascript">
  // based on http://stackoverflow.com/a/10300743/280842
  function gen_mail_to_link(hs, subject) {
    var lhs,rhs;
    var p = hs.split('@');
    lhs = p[0];
    rhs = p[1];
    document.write("<a class=\"social-link-item\" target=\"_blank\" href=\"mailto");
    document.write(":" + lhs + "@");
    document.write(rhs + "?subject=" + subject + "\"><i class=\"fa fa-fw fa-envelope\"></i><\/a>");
  }
</script>
<div class="social-links">
  <ul>
    
    
    
    
    <li><a href="http://linkedin.com/in/https://www.linkedin.com/in/paulosuzart/" class="social-link-item" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a></li>
    
    
    
    
    <li><a href="http://github.com/github.com/paulosuzart" class="social-link-item" target="_blank"><i class="fa fa-fw fa-github"></i></a></li>
    
    
    
    
    
    
    
    
    
    
    
    
    
  </ul>
</div>

</div>

      </div>
    </div>
    <div class="col s12 m9">
      <div class="post-listing">
        <a class="btn" href= "http://localhost:4000/" >
  Home
</a>



<div id="post">
  <header class="post-header">
    <h1 title="Web Noir plus enlive template">Web Noir plus enlive template</h1>
    <span class="post-meta">
      <span class="post-date">
        25 MAR 2012
      </span>
      •
      <span class="read-time" title="Estimated read time">
  
  
    4 mins read
  
</span>

    </span>

  </header>

  <article class="post-content">
    <p>Hi again! Long time without writing here. But for a good reason.</p>

<p>One of the most promising web frameworks for <a href="http://clojure.org/">clojure</a> is <a href="http://www.webnoir.org/">noir</a>. It is actually an abstraction on top of <a href="https://github.com/mmcgrana/ring/">ring</a> and <a href="https://github.com/weavejester/compojure">Compojure</a>, both successful clojure products.</p>

<p>By default, noir comes with the excellent <a href="https://github.com/weavejester/hiccup">hiccup</a>, which allows one write html in clojure like this:
<!--more--></p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span></span>    <span class="p">(</span><span class="nf">use</span> <span class="ss">&#39;hiccup.core</span><span class="p">)</span>
    <span class="p">(</span><span class="k">def </span><span class="nb">name </span><span class="s">&quot;Nacho&quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">html</span> <span class="p">[</span><span class="ss">:span</span> <span class="p">{</span><span class="ss">:id</span> <span class="s">&quot;dog&quot;</span><span class="p">}</span> <span class="nv">name</span><span class="p">])</span>

    <span class="c1">;; produces:</span>
    <span class="c1">;;&quot;&lt;span id=\&quot;dog\&quot;&gt;Nacho&lt;/span&gt;&quot;</span></code></pre></figure>

<!--more-->

<p>It doesn’t look designer friendly, right? I would still use hiccup for admin pages or small chunks of html strictly generated by clojure code with a good css to help presenting it.</p>

<p>Enters enlive. I’ve already used enlive <a href="http://codemountain.wordpress.com/2010/10/09/clojure-macros/">before</a>, without understanding it that much, I would say. It’s been almost two years since that post. And what makes me happy with enlive is the possibility to be closer to <a href="http://www.scala-lang.org/">Scala’s</a> web framework <a href="http://liftweb.net/">Lift</a>. That is, put some attention on the view with actually working with actions. So, combine this:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span></span>    <span class="p">&lt;</span><span class="nt">form</span>  <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;login_form&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;errors&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;username&quot;</span><span class="p">&gt;</span>Username<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;username&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;username&quot;</span><span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">&gt;</span>Password<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Login&quot;</span><span class="p">/&gt;</span>
     <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span></code></pre></figure>

<p>With a snippet from enlive:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">show-errors</span> <span class="p">[</span><span class="nv">msgs</span><span class="p">]</span>
	<span class="p">(</span><span class="nf">h/clone-for</span> <span class="p">[</span><span class="nv">i</span> <span class="nv">msgs</span><span class="p">]</span>
		<span class="p">[</span><span class="ss">:span.error</span><span class="p">]</span>
		<span class="p">(</span><span class="nf">h/content</span> <span class="nv">i</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">h/defsnippet</span> <span class="nv">_login</span> <span class="s">&quot;mayapp/views/_login.html&quot;</span>  <span class="p">[</span><span class="ss">:#login_form</span><span class="p">]</span>
	<span class="p">[</span><span class="nv">username</span> <span class="nv">password</span> <span class="o">&amp;</span> <span class="p">[</span><span class="nv">errors</span><span class="p">]]</span>

	<span class="c1">;;find sa div with ir=&#39;errors&#39;</span>
	<span class="p">[</span><span class="ss">:div#errors</span><span class="p">]</span>
	<span class="p">(</span><span class="nf">show-errors</span> <span class="nv">errors</span><span class="p">)</span>

	<span class="c1">;;finds an input with id =&#39;username&#39; and replaces</span>
	<span class="c1">;;its value attribute by username</span>
	<span class="p">[</span><span class="ss">:input#username</span><span class="p">]</span>
	<span class="p">(</span><span class="nf">h/set-attr</span> <span class="ss">:value</span> <span class="nv">username</span><span class="p">)</span>

	<span class="c1">;;the same for password</span>
	<span class="p">[</span><span class="ss">:input#password</span><span class="p">]</span>
	<span class="p">(</span><span class="nf">h/set-attr</span> <span class="ss">:value</span> <span class="nv">password</span><span class="p">))</span></code></pre></figure>

<p>And you have the html output that can be referenced this way:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span></span><span class="p">(</span><span class="nf">defpage</span> <span class="s">&quot;/login&quot;</span> <span class="p">{</span><span class="ss">:as</span> <span class="nv">login</span><span class="p">}</span>
    <span class="p">(</span><span class="nf">_login</span> <span class="p">(</span><span class="ss">:username</span> <span class="nv">login</span><span class="p">)</span>
		<span class="p">(</span><span class="ss">:password</span> <span class="nv">login</span><span class="p">)</span>
		<span class="p">(</span><span class="ss">:error</span> <span class="nv">login</span><span class="p">)))))</span>

<span class="c1">;;handling the form submit</span>
<span class="p">(</span><span class="nf">defpage</span> <span class="p">[</span><span class="ss">:post</span> <span class="s">&quot;/login&quot;</span><span class="p">]</span> <span class="p">{</span><span class="ss">:as</span> <span class="nv">login</span><span class="p">}</span>
	<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">valid?</span> <span class="nv">login</span><span class="p">)</span>
		<span class="p">(</span><span class="nf">format</span> <span class="s">&quot;Yeah!! Welcome %s&quot;</span> <span class="p">(</span><span class="ss">:username</span> <span class="nv">login</span><span class="p">))</span>
		<span class="p">(</span><span class="nf">render</span> <span class="s">&quot;/login&quot;</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">login</span> <span class="ss">:error</span> <span class="p">(</span><span class="nf">v/get-errors</span><span class="p">)))))</span></code></pre></figure>

<p>We still have sort of action base framework but with good attention to the view. Not the <code>show-errors</code> function, that can be reused every where with a <code>:div#errors &gt; :span.error</code>. It will repeat the span for every error in <code>msgs</code>.</p>

<p>The error messages may be produce by <code>noir.validation</code> package. In the <code>POST</code> route you can see the snippet being activated with the <code>[errors]</code> argument in case of any errors.</p>

<p>Snippets should be natural for you, and can be used in situations where you define parts of an html, you you have a bigger html resource grouping many parts that cane be a snippet. That is why you passes a selector to <code>defsnipet</code> right after the resource name. That is, transformations will start from this point.</p>

<p>The other option is the <code>deftemplate</code>, it works similar to <code>defsnippet</code>, but doesn’t take any selector as an argument, because it process the entire resource.</p>

<p>A great usage of enlive you can find at <a href="https://github.com/metadaddy-sfdc/facebook-template-clojure/">Facebook/Heroku sample app – Clojure</a>.</p>

<p>And to help you starting with noir plus enlive, I’ve created a template project using <a href="https://github.com/Raynes/lein-newnew">lein-newnew</a>, a way to pack a project as a template, so anyone can reuse it. Please refer to <a href="https://clojars.org/clj-enlive-template">https://clojars.org/clj-enlive-template</a> and the <a href="https://github.com/paulosuzart/clj-enlive-template">clj-enlive-template</a> source code. Just:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>lein plugin install clj-enlive-template <span class="m">0</span>.0.1
lein new clj-enlive-template myproj
<span class="nb">cd</span> myproj
lein run</code></pre></figure>

<p>And start having fun with enlive and noir. This project template may be evolved to have <a href="http://sqlkorma.com/">korma</a> or any persistence framework.</p>

  </article>
</div>

<div class="share-buttons">
  <h6>Share on: </h6>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/blog/2012/03/25/web-noir-plus-enlive-template/" class="twitter btn" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/blog/2012/03/25/web-noir-plus-enlive-template/" class="facebook btn" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=http://localhost:4000/blog/2012/03/25/web-noir-plus-enlive-template/" class="google-plus btn" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
    <li>
      <a href="https://news.ycombinator.com/submitlink?u=http://localhost:4000/blog/2012/03/25/web-noir-plus-enlive-template/" class="hacker-news btn" title="Share on Hacker News"><i class="fa fa-hacker-news"></i><span> Hacker News</span></a>
    </li>
    <li>
      <a href="https://www.reddit.com/submit?url=http://localhost:4000/blog/2012/03/25/web-noir-plus-enlive-template/" class="reddit btn" title="Share on Reddit"><i class="fa fa-reddit"></i><span> Reddit</span></a>
    </li>
  </ul>
</div><!-- end share-buttons -->


<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'paulosuzartblog';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



        <footer>
  &copy; 2017 Paulo Suzart. Powered by <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://github.com/renyuanz/leonids/">leonids theme</a> made with <i class="fa fa-heart heart-icon"></i>
</footer>

      </div>
    </div>
  </div>
  <script type="text/javascript" src="http://localhost:4000/js/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="http://localhost:4000/js/main.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-26676810-1', 'auto');
  ga('send', 'pageview');
</script>


</body>
</html>
